import pandas as pd
import numpy as np
df=pd.read_csv("https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DS0321EN-SkillsNetwork/datasets/dataset_part_1.csv")
#print(df.head(10))
#Identify and calculate the percentage of the missing values in each attribute
#print(df.isnull().sum()/len(df)*100)
#print(df.dtypes)
counts=df['LaunchSite'].value_counts()
#print(counts)
Orbit_outcome=df['Orbit'].value_counts()
#print(Orbit_outcome)
Landing_outcome=df['Outcome'].value_counts()
for i,outcome in enumerate(Landing_outcome.keys()):
    print(i,outcome)
bad_outcomes=set(Landing_outcome.keys()[[1,3,5,6,7]])
#print(bad_outcomes)
bad_outcome=[1,3,5,6,7]
for i in df['Outcome']:
    if i in bad_outcome:
        landing_class=0
    else:
        landing_class=1
    print(landing_class)    
df['Class']= landing_class
print(df['Class'].head())
success_rate=df['Class'].mean()
print(success_rate)
df.to_csv("dataset_part_2.csv", index=False)